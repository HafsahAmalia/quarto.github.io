---
title: "Imputation via Joint Modelling"
author: "Thomas Debray, PhD"
format: revealjs
engine: knitr
---

## Imputation via Joint Modelling

![](Picture 1.png){width=80% height=600}


## Imputation via Joint Modelling

It is common to assume that all data follow a multivariate Normal or Student-T distribution

$(ğ‘¥_1,ğ‘¥_2,ğ‘¦) \sim MVN (ğœ‡,"Î£" )$

For now, we consider that

- The mean vector Î¼ is known
- The covariance matrix Î£ is known

## Imputation via Joint Modelling

![](Picture 2.png){width=100%}

## Imputation via Joint Modelling

How to use the conditional mean?

- $ğœ‡_1^âˆ—$ is the most likely value for $ğ‘¥_1$, and can thus be used as imputation.
- $ğœ‡_1^âˆ—$ is equal to the mean of $ğ‘¥_1$ plus an adjustment. 

    - If there is little correlation between the predictors and outcomes, then the best guess for $ğ‘¥_1$ is the mean of $ğ‘¥_1$.

## Imputation via Joint Modelling

**Example**

Multivariate distribution of patients presenting with lower respiratory tract infections in primary care:

- Age, years: mean = 52, SD = 16
- C-reactive protein: mean = 53, SD = 62
- Temperature, CÂ°: mean = 37.5, SD = 0.8
- Cor (Age, CRP) = 0.09
- Cor(Age, Temperature) = -0.15
- Cor(CRP, Temperature) = 0.25

## Imputation via Joint Modelling

![](Picture 3.png){width=100%}


## Imputation via Joint Modelling

![](Picture 4.png){width=100%}


## Imputation via Joint Modelling

![](Picture 5.png){width=100%}


## Imputation via Joint Modelling

![](Picture 6.png){width=100%}


## Imputation via Joint Modelling

How to use the conditional variance?

- "Var" $(ğ‘¥_1â”‚ğ‘¥_2, ğ‘¦)$ quantifies the variance of $ğœ‡_1^âˆ—$ , and can be used to draw multiple imputations. In particular, we can sample an imputed value from a Normal distribution with mean $ğœ‡_1^âˆ—$ and variance "Var" $(ğ‘¥_1â”‚ğ‘¥_2, ğ‘¦)$

- "Var" $(ğ‘¥_1â”‚ğ‘¥_2, ğ‘¦)$  is equal to the variance of $ğ‘¥_1$ minus an adjustment. 
If there is little correlation between the predictors and outcomes, then the variance of imputed values for $ğ‘¥_1$ is equal to the variance of $ğ‘¥_1$ in the original population.


## Imputation via Joint Modelling

![](Picture 7.png){width=100%}

## Imputation via Joint Modelling

![](Picture 8.png){width=100%}


## Imputation via Joint Modelling

::: {style="font-size: 0.85em"}
**So, how to generate an imputed dataset?**

An iterative procedure is needed:

- Estimate Î¼ and Î£ 
- Use Î¼ and Î£ to impute the missing values
- Update estimates of Î¼ and Î£ using the imputed values
- Continue until estimates of Î¼ and Î£ stabilize

This approach is known as the **Gibbs sampler**

A natural choice for the initial estimates of Î¼ and Î£ is to derive them directly using the complete data only.
:::

## Imputation via Joint Modelling

![](Picture 9.png){width=100%}


## Imputation via Joint Modelling

![](Picture 10.png){width=100%}


## Imputation via Joint Modelling

![](Picture 11.png){width=100%}


## Imputation via Joint Modelling

![](Picture 12.png){width=100%}


## Imputation via Joint Modelling

![](Picture 13.png){width=100%}


## Imputation via Joint Modelling

![](Picture 14.png){width=100%}



## Imputation via Joint Modelling

**Illustration of the Gibbs sampler**

- We impute missing values using the new estimates for Î¼ and "Î£", and re-estimate Î¼ and "Î£" . 
- We iterate this procedure many times. 
- Eventually, we should obtain reliable estimates for Î¼ and "Î£" , and thus also obtain imputations that properly reflect their uncertainty


## Imputation via Joint Modelling

![](Picture 15.png){width=100%}

## Imputation via Joint Modelling

**How to ensure that we end up in the posterior distribution?**

- Allow for sufficient imputation cycles!
- Repeat the whole process from different starting points

    - E.g. Estimate the initial version of Î¼ and Î£ in a dataset where all missing values have been replaced by a random value

## Imputation via Joint Modelling

![](Picture 16.png){width=100%}

## Imputation via Joint Modelling

![](Picture 17.png){width=100%}

## Imputation via Joint Modelling

![](Picture 18.png){width=100%}
## Imputation via Joint Modelling

**Final considerations**

- Normality assumptions may not always be realistic

    - Non-continuous data
    - Skewed data
    - Nonlinear data
    - Clustered data

- Several extensions have been proposed to accommodate for this





